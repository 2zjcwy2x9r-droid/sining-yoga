# 微信开发者工具配置步骤（图文说明）

## 问题现象

小程序模拟器中显示错误：
- **"网络配置错误"**
- **"域名未配置,请检查开发者工具设置"**

## 解决方案：开启"不校验合法域名"

### 步骤 1：打开"详情"设置

1. 在微信开发者工具**顶部工具栏**，找到并点击 **"详情"** 按钮
   - 位置：工具栏最右侧，在"消息"按钮旁边

### 步骤 2：进入"本地设置"

1. 点击"详情"后，会弹出项目详情窗口
2. 在左侧菜单中找到并点击 **"本地设置"** 标签页

### 步骤 3：勾选"不校验合法域名"

在"本地设置"页面中，找到以下选项并**全部勾选**：

✅ **"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"**
   - 这个选项允许开发环境使用 HTTP 和非官方域名

✅ **"不校验安全域名、TLS版本以及HTTPS证书"**
   - 这个选项允许开发环境跳过安全域名校验

### 步骤 4：保存并重新编译

1. 勾选完成后，设置会自动保存
2. 点击工具栏的 **"编译"** 按钮（或按快捷键 `Ctrl+B` / `Cmd+B`）
3. 小程序会重新加载，错误提示应该消失

## 完整路径总结

```
微信开发者工具顶部工具栏
  └─> 点击 "详情" 按钮
      └─> 左侧菜单选择 "本地设置"
          └─> 勾选 "不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"
          └─> 勾选 "不校验安全域名、TLS版本以及HTTPS证书"
              └─> 点击 "编译" 重新加载
```

## 注意事项

### ⚠️ 重要提示

1. **这些设置仅用于开发环境**
   - 生产环境必须配置合法的 HTTPS 域名
   - 必须在微信公众平台配置服务器域名

2. **确保后端服务正在运行**
   - 检查：`curl http://localhost:8080/health`
   - 确保返回 `{"status":"ok"}`

3. **确保 API 地址配置正确**
   - 编辑 `miniprogram/app.js`
   - 将 `apiBaseUrl` 改为你的本机 IP（不能使用 localhost）
   ```javascript
   globalData: {
     apiBaseUrl: 'http://21.6.230.48:8080/api/v1'  // 使用你的实际IP
   }
   ```

## 如果仍然报错

### 检查清单

1. ✅ **已勾选"不校验合法域名"选项**
2. ✅ **已重新编译小程序**
3. ✅ **后端服务正在运行**（端口 8080）
4. ✅ **API 地址使用 IP 而非 localhost**
5. ✅ **手机和电脑在同一 WiFi 网络**（真机调试时）

### 清除缓存

如果问题仍然存在，尝试：

1. 点击工具栏 **"清缓存"** 按钮
2. 选择 **"清除全部缓存"**
3. 重新编译

### 查看网络请求

1. 打开 **"调试器"** 标签页
2. 切换到 **"Network"** 子标签
3. 查看请求是否发出
4. 检查请求 URL 是否正确
5. 查看响应状态码和错误信息

## 配置后的效果

配置成功后：
- ✅ 错误提示消失
- ✅ 可以正常发送消息
- ✅ 可以正常接收 AI 回复
- ✅ Network 面板显示请求成功（状态码 200）

## 下一步

配置完成后，可以：
1. 测试 AI 聊天功能
2. 测试知识库查询
3. 测试课程预订功能

如果还有问题，请查看：
- `MINIPROGRAM_SETUP.md` - 完整配置指南
- 微信开发者工具控制台的错误信息

