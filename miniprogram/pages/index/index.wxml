<!--pages/index/index.wxml-->
<view class="container">
  <!-- 顶部Banner区域 -->
  <view class="banner">
    <view class="banner-content">
      <text class="banner-title">瑜伽课程</text>
      <text class="banner-subtitle">Yoga Classes</text>
    </view>
    <view class="banner-decoration"></view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>

  <!-- 周一到周日列表 -->
  <view wx:else class="week-list">
    <view 
      wx:for="{{weekSchedule}}" 
      wx:key="dayIndex"
      wx:for-item="day"
      class="week-item {{day.classes.length > 0 ? 'has-classes' : ''}}"
      bindtap="selectDay"
      data-index="{{day.dayIndex}}"
    >
      <view class="week-item-left">
        <view class="week-day-info">
          <text class="week-day-name">{{day.dayName}}</text>
          <text class="week-date">{{day.dateLabel}}</text>
        </view>
        <view wx:if="{{day.classes.length > 0}}" class="week-classes-info">
          <text class="week-classes-count">{{day.classes.length}}节课程</text>
          <text class="week-classes-time">{{day.classes[0].startTime}}{{day.classes.length > 1 ? ' - ' + day.classes[day.classes.length - 1].endTime : ''}}</text>
        </view>
        <view wx:else class="week-no-classes">
          <text class="no-classes-text">暂无课程</text>
        </view>
      </view>
      <view class="week-item-right">
        <view wx:if="{{day.classes.length > 0}}" class="week-badge">{{day.classes.length}}</view>
        <text class="week-arrow">›</text>
      </view>
    </view>
  </view>

  <!-- 课程详情弹窗 -->
  <view wx:if="{{showModal}}" class="modal-mask" bindtap="closeModal">
    <view class="modal-content" catchtap="preventClose">
      <view class="modal-header">
        <view class="modal-title">
          <text class="modal-day-name">{{selectedDay.dayName}}</text>
          <text class="modal-date">{{selectedDay.date}}</text>
        </view>
        <text class="modal-close" bindtap="closeModal">✕</text>
      </view>

      <view class="modal-body">
        <view wx:if="{{selectedDay.classes.length > 0}}" class="modal-classes-list">
          <view 
            wx:for="{{selectedDay.classes}}" 
            wx:for-item="class"
            wx:key="id" 
            class="modal-class-card"
            bindtap="navigateToClassDetail"
            data-id="{{class.id}}"
          >
            <view class="modal-class-time">
              <text class="modal-time-range">{{class.startTime}} - {{class.endTime}}</text>
              <text class="modal-time-duration">{{class.duration}}分钟</text>
            </view>
            
            <view class="modal-class-info">
              <view class="modal-class-header">
                <text class="modal-class-name">{{class.name}}</text>
                <view class="modal-class-status {{class.available ? 'available' : 'full'}}">
                  {{class.available ? '可预订' : '已满'}}
                </view>
              </view>
              
              <view class="modal-class-details">
                <view class="modal-detail-row">
                  <text class="modal-detail-label">老师：</text>
                  <text class="modal-detail-value">{{class.instructor || '待定'}}</text>
                </view>
                <view class="modal-detail-row">
                  <text class="modal-detail-label">时长：</text>
                  <text class="modal-detail-value">{{class.duration}}分钟</text>
                </view>
                <view class="modal-detail-row">
                  <text class="modal-detail-label">已预订：</text>
                  <text class="modal-detail-value">{{class.booked_count || 0}}/{{class.capacity || 0}}人</text>
                </view>
              </view>
            </view>
          </view>
        </view>
        
        <view wx:else class="modal-empty">
          <text class="modal-empty-text">该日暂无课程</text>
        </view>
      </view>
    </view>
  </view>
</view>
