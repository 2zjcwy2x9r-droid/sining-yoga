<!--pages/booking/index.wxml-->
<view class="container">
  <!-- å‘¨ä¸€åˆ°å‘¨æ—¥æ—¥æœŸé€‰æ‹©å™¨ -->
  <view class="week-selector">
    <scroll-view class="week-scroll" scroll-x="true" scroll-with-animation="true" scroll-left="{{selectedDayIndex * 120}}">
      <view class="week-container">
        <view 
          wx:for="{{weekSchedule}}" 
          wx:key="dayIndex"
          wx:for-item="day"
          class="week-day-item {{selectedDayIndex === day.dayIndex ? 'selected' : ''}}"
          bindtap="selectDay"
          data-index="{{day.dayIndex}}"
        >
          <text class="week-day-label">{{day.dateLabel}}</text>
          <text class="week-day-number">{{day.date.split('-')[2]}}</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- è¯¾ç¨‹åˆ—è¡¨ -->
  <view wx:else class="classes-container">
    <view wx:if="{{classes.length > 0}}" class="classes-list">
      <view 
        wx:for="{{classes}}" 
        wx:key="id" 
        wx:for-item="class"
        class="class-card"
        bindtap="navigateToClassDetail"
        data-id="{{class.id}}"
      >
        <!-- è¯¾ç¨‹æ ‡é¢˜å’Œä»·æ ¼ -->
        <view class="class-header">
          <text class="class-name">{{class.name}}</text>
          <text class="class-price">å…è´¹</text>
        </view>

        <!-- è¯¾ç¨‹ä¿¡æ¯ -->
        <view class="class-info">
          <view class="info-row">
            <text class="info-icon">ğŸ“</text>
            <text class="info-text">ç‘œä¼½æ•™å®¤ | è·ç¦»æ‚¨500m</text>
          </view>
          <view class="info-row">
            <text class="info-icon">ğŸ•</text>
            <text class="info-text">{{weekSchedule[selectedDayIndex] ? weekSchedule[selectedDayIndex].fullDate : ''}} {{weekSchedule[selectedDayIndex] ? weekSchedule[selectedDayIndex].dayName : ''}} {{class.startTime}}-{{class.endTime}}</text>
          </view>
          <view class="info-row">
            <text class="info-icon">ğŸ‘¤</text>
            <text class="info-text">è€å¸ˆï¼š{{class.instructor || 'å¾…å®š'}}</text>
          </view>
        </view>

        <!-- å‚ä¸äººæ•°å’Œé¢„è®¢æŒ‰é’® -->
        <view class="class-footer">
          <view class="class-participants">
            <view class="participant-avatars">
              <view class="avatar-placeholder"></view>
              <view class="avatar-placeholder"></view>
              <view class="avatar-placeholder"></view>
            </view>
            <text class="participant-text">æŠ¥åä¸­ {{class.bookedCount || 0}}/{{class.capacity || 0}}</text>
          </view>
          <button 
            class="book-button {{class.available ? '' : 'disabled'}}"
            bindtap="bookClass"
            data-id="{{class.id}}"
            disabled="{{!class.available}}"
            catchtap="stopPropagation"
          >
            {{class.available ? 'å»æŠ¥å' : 'å·²æ»¡'}}
          </button>
        </view>
      </view>
    </view>

    <!-- æ— è¯¾ç¨‹æç¤º -->
    <view wx:else class="empty-state">
      <text class="empty-icon">ğŸ“…</text>
      <text class="empty-text">è¯¥æ—¥æš‚æ— è¯¾ç¨‹</text>
      <text class="empty-hint">è¯·é€‰æ‹©å…¶ä»–æ—¥æœŸæŸ¥çœ‹è¯¾ç¨‹</text>
    </view>
  </view>
</view>
